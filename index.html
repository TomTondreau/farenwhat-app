<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>쮽ahren What? 쮺elsius Who?</title>
    <link rel="stylesheet" href="teenage-engineering.css">
</head>
<body>

    <div class="te-container">
        <div class="te-header">
            Fahren What? Celsius Who?
        </div>

        <!-- Secci칩n del Conversor -->
        <div class="te-section">
            <div class="te-status-display">
                <img src="logo.png" alt="쮽ahren What? 쮺elsius Who? Logo" class="te-logo">
                <span id="status-emoji" class="te-status-emoji"></span>
                <p id="temperature-fact" class="te-fact-text"></p>
            </div>

            <div class="te-input-grid">
                <div class="te-input-group">
                    <label for="celsius" class="te-label">Celsius (춿C)</label>
                    <input type="number" id="celsius" placeholder="Ej: 74" class="te-input">
                </div>
                <div class="te-input-group">
                    <label for="fahrenheit" class="te-label">Fahrenheit (춿F)</label>
                    <input type="number" id="fahrenheit" placeholder="Ej: 165" class="te-input">
                </div>
            </div>
        </div>

        <!-- Secci칩n de la Gu칤a de Cocci칩n -->
        <div class="te-section">
            <h2 class="te-section-title">Encuentra el punto ideal</h2>
            <div class="te-search-group">
                <input type="search" id="search-guide" placeholder="游댌 Buscar corte (ej: Lomo, Salm칩n...)" class="te-search-input">
            </div>
            <div id="cooking-guide" class="te-cooking-guide"></div>
            
            <div id="web-search-container" class="te-web-search-container" style="display: none;">
                <p>No se encontraron resultados para "<span id="search-term-display"></span>".</p>
                <a id="web-search-link" href="#" target="_blank" rel="noopener noreferrer" class="te-link">
                    Buscar en Google
                </a>
            </div>
        </div>
    </div>

    <script>
        const elements = {
            celsiusInput: document.getElementById('celsius'),
            fahrenheitInput: document.getElementById('fahrenheit'),
            statusEmoji: document.getElementById('status-emoji'),
            temperatureFact: document.getElementById('temperature-fact'),
            cookingGuide: document.getElementById('cooking-guide'),
            searchInput: document.getElementById('search-guide'),
            webSearchContainer: document.getElementById('web-search-container'),
            webSearchLink: document.getElementById('web-search-link'),
            searchTermDisplay: document.getElementById('search-term-display')
        };

        const cookingData = [
            { region: 'Vacuno / Res', cut: 'Filete / Lomo', doneness: [
                { level: 'Rare', tempC: 52, tempF: 125 },
                { level: 'Medium Rare', tempC: 55, tempF: 131 },
                { level: 'Medium', tempC: 60, tempF: 140 },
                { level: 'Medium Well', tempC: 65, tempF: 150 },
                { level: 'Well Done', tempC: 71, tempF: 160 }
            ]},
            { region: 'Vacuno / Res', cut: 'Lomo Vetado', doneness: [
                { level: 'Medium Rare', tempC: 55, tempF: 131 },
                { level: 'Medium', tempC: 60, tempF: 140 },
                { level: 'Well Done', tempC: 71, tempF: 160 }
            ]},
            { region: 'Vacuno / Res', cut: 'Asado de Tira', tempC: 88, tempF: 190 },
            { region: 'Vacuno / Res', cut: 'Punta de Ganso', doneness: [
                { level: 'Medium', tempC: 60, tempF: 140 },
                { level: 'Well Done', tempC: 71, tempF: 160 }
            ]},
            { region: 'Vacuno / Res', cut: 'Hamburguesas', tempC: 71, tempF: 160 },
            { region: 'Vacuno / Res', cut: 'Brisket (BBQ)', tempC: 93, tempF: 200 },
            { region: 'Vacuno / Res', cut: 'Vac칤o', doneness: [
                { level: 'Jugoso', tempC: 60, tempF: 140 },
                { level: 'Cocido', tempC: 71, tempF: 160 }
            ]},
            { region: 'Cerdo', cut: 'Costillar de Cerdo (BBQ)', tempC: 90, tempF: 195 },
            { region: 'Cerdo', cut: 'Pulled Pork', tempC: 93, tempF: 200 },
            { region: 'Cerdo', cut: 'Lomo de Cerdo', tempC: 63, tempF: 145 },
            { region: 'Cerdo', cut: 'Chuletas de Cerdo', tempC: 63, tempF: 145 },
            { region: 'Aves', cut: 'Pollo Entero', tempC: 74, tempF: 165 },
            { region: 'Aves', cut: 'Pechuga de Pollo', tempC: 74, tempF: 165 },
            { region: 'Aves', cut: 'Muslos de Pollo', tempC: 79, tempF: 175 },
            { region: 'Aves', cut: 'Pavo (Pechuga)', tempC: 74, tempF: 165 },
            { region: 'Cordero', cut: 'Pierna de Cordero', doneness: [
                { level: 'Medium', tempC: 63, tempF: 145 },
                { level: 'Well Done', tempC: 71, tempF: 160 }
            ]},
            { region: 'Cordero', cut: 'Chuletas de Cordero', doneness: [
                { level: 'Medium Rare', tempC: 57, tempF: 135 },
                { level: 'Medium', tempC: 63, tempF: 145 }
            ]},
            { region: 'Pescado', cut: 'Salm칩n', tempC: 60, tempF: 140 },
            { region: 'Pescado', cut: 'At칰n (Sellado)', tempC: 49, tempF: 120 },
            { region: 'Pescado', cut: 'Merluza / Corvina', tempC: 63, tempF: 145 },
            { region: 'Prote칤nas Ex칩ticas', cut: 'Carne de Cocodrilo', tempC: 74, tempF: 165 },
            { region: 'Prote칤nas Ex칩ticas', cut: 'Ancas de Rana', tempC: 74, tempF: 165 },
            { region: 'Prote칤nas Ex칩ticas', cut: 'Ciervo / Venado', doneness: [
                { level: 'Medium Rare', tempC: 57, tempF: 135 },
                { level: 'Medium', tempC: 63, tempF: 145 }
            ]}
        ];

        function celsiusToFahrenheit(celsius) { return (celsius * 9/5) + 32; }
        function fahrenheitToCelsius(fahrenheit) { return (fahrenheit - 32) * 5/9; }

        function updateStatus(celsius) {
            const { statusEmoji, temperatureFact } = elements;
            let fact = "";

            if (celsius === null || isNaN(celsius)) {
                statusEmoji.textContent = '...';
                fact = "Esperando entrada.";
            } else if (celsius < 0) {
                statusEmoji.textContent = '--';
                fact = "Demasiado fr칤o.";
            } else if (celsius <= 4) {
                statusEmoji.textContent = '--';
                fact = "Refrigeraci칩n.";
            } else if (celsius < 60) {
                statusEmoji.textContent = '!';
                fact = "Zona de riesgo.";
            } else if (celsius < 74) {
                statusEmoji.textContent = 'OK';
                fact = "Cocci칩n perfecta.";
            } else if (celsius < 100) {
                statusEmoji.textContent = '++';
                fact = "Temperatura alta.";
            } else if (celsius < 150) {
                statusEmoji.textContent = '!!';
                fact = "Muy caliente!";
            } else {
                statusEmoji.textContent = '!!!';
                fact = "Extremo!";
            }
            temperatureFact.textContent = fact;
        }

        function populateGuide() {
            const { cookingGuide } = elements;
            const popularThreshold = 3;
            cookingGuide.innerHTML = '';
            const groupedByRegion = cookingData.reduce((acc, item) => {
                acc[item.region] = acc[item.region] || [];
                acc[item.region].push(item);
                return acc;
            }, {});

            for (const region in groupedByRegion) {
                const items = groupedByByRegion[region];
                const section = document.createElement('div');
                section.className = 'te-guide-region-section';
                
                const title = document.createElement('h3');
                title.className = 'te-section-subtitle';
                title.textContent = region;
                section.appendChild(title);

                const list = document.createElement('ul');
                list.className = 'te-list';
                
                items.forEach((item, index) => {
                    const listItem = document.createElement('li');
                    listItem.className = 'te-list-item';
                    if (index >= popularThreshold) {
                        listItem.style.display = 'none';
                        listItem.classList.add('extra-item');
                    }

                    let contentHTML = `<span>${item.cut}</span>`;
                    if (item.doneness) {
                        contentHTML += `<span class="te-temp-label">Puntos de Cocci칩n</span>`;
                        item.doneness.forEach(d => {
                            contentHTML += `<div class="te-sub-item"><span>- ${d.level}</span><span class="te-temp-value">${d.tempC}춿C / ${d.tempF}춿F</span></div>`;
                        });
                    } else {
                        contentHTML += `<span class="te-temp-value">${item.tempC}춿C / ${item.tempF}춿F</span>`;
                    }
                    listItem.innerHTML = contentHTML;
                    list.appendChild(listItem);
                });

                section.appendChild(list);

                if (items.length > popularThreshold) {
                    const button = document.createElement('button');
                    button.textContent = 'Ver m치s...';
                    button.className = 'show-more-btn te-button';
                    button.onclick = (e) => {
                        const listContainer = e.target.previousElementSibling;
                        const extraItems = listContainer.querySelectorAll('.extra-item');
                        extraItems.forEach(item => item.style.display = 'flex');
                        e.target.style.display = 'none';
                    };
                    section.appendChild(button);
                }
                cookingGuide.appendChild(section);
            }
        }

        function handleSearch() {
            const { searchInput, cookingGuide, webSearchContainer, searchTermDisplay, webSearchLink } = elements;
            const searchTerm = searchInput.value.toLowerCase().trim();
            const sections = cookingGuide.querySelectorAll('.te-guide-region-section');
            let totalVisibleItems = 0;

            sections.forEach(section => {
                const listItems = section.querySelectorAll('.te-list-item');
                let visibleItemsInSection = 0;

                listItems.forEach(item => {
                    const cutName = item.querySelector('span:first-child').textContent.toLowerCase();
                    if (cutName.includes(searchTerm)) {
                        item.style.display = 'flex';
                        visibleItemsInSection++;
                    } else {
                        item.style.display = 'none';
                    }
                });

                const showMoreBtn = section.querySelector('.show-more-btn');
                if (showMoreBtn) {
                    showMoreBtn.style.display = 'none';
                }

                if (visibleItemsInSection > 0) {
                    section.style.display = 'block';
                    totalVisibleItems += visibleItemsInSection;
                } else {
                    section.style.display = 'none';
                }
            });

            if (searchTerm === '') {
                populateGuide();
                webSearchContainer.style.display = 'none';
            } else if (totalVisibleItems === 0) {
                searchTermDisplay.textContent = searchInput.value;
                webSearchLink.href = `https://www.google.com/search?q=temperatura+interna+de+coccion+${encodeURIComponent(searchInput.value)}`;
                webSearchContainer.style.display = 'block';
            } else {
                webSearchContainer.style.display = 'none
            }
        }

        elements.celsiusInput.addEventListener('input', () => {
            const cValue = parseFloat(elements.celsiusInput.value);
            if (!isNaN(cValue)) { elements.fahrenheitInput.value = celsiusToFahrenheit(cValue).toFixed(1); }
            else { elements.fahrenheitInput.value = ''; }
            updateStatus(isNaN(cValue) ? null : cValue);
        });

        elements.fahrenheitInput.addEventListener('input', () => {
            const fValue = parseFloat(elements.fahrenheitInput.value);
            if (!isNaN(fValue)) {
                const cValue = fahrenheitToCelsius(fValue);
                elements.celsiusInput.value = cValue.toFixed(1);
                updateStatus(cValue);
            } else {
                elements.celsiusInput.value = '';
                updateStatus(null);
            }
        });

        elements.searchInput.addEventListener('input', handleSearch);

        updateStatus(null);
        populateGuide();

    </script>

</body>
</html>